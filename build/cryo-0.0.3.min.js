/*
 The MIT license.
 @copyright Copyright (c) 2010 Skookum, skookum.com
*/
(function(){function f(a){return"object"===typeof a?a instanceof Array?"array":a instanceof Date?"date":"object":typeof a}function m(a,b,d){d=d||[];var c=f(a);if(-1!==t.indexOf(c)){c=d.indexOf(a);if(-1===c){var c={},e;for(e in a)a.hasOwnProperty(e)&&(c[e]=m(a[e],b,d));c=b.push({contents:c,value:n(a)})-1;d[c]=a}return g+c}return n(a)}function p(a,b){if(h(a,g)){var d=parseInt(a.slice(g.length),10),c=b[d],d=q(c.value),c=c.contents,e;for(e in c)d[e]=p(c[e],b);return d}return q(a)}function n(a){var b=
f(a);return"undefined"===b?r:"function"===b?j+a.toString():"date"===b?k+a.getTime():Infinity===a?s:a}function q(a){if("string"===f(a)){if(a===r)return;if(h(a,j)){a=a.slice(j.length);var b=a.indexOf("(")+1,d=a.indexOf(")",b),b=a.slice(b,d),d=a.indexOf("{")+1,c=a.lastIndexOf("}")-1;a=a.slice(d,c);return new Function(b,a)}if(h(a,k))return a=parseInt(a.slice(k.length),10),new Date(a);if(a===s)return Infinity}return a}function h(a,b){return"string"===f(a)&&a.slice(0,b.length)===b}var t=["object","array",
"date","function"],g="_CRYO_REF_",s="_CRYO_INFINITY_",j="_CRYO_FUNCTION_",r="_CRYO_UNDEFINED_",k="_CRYO_DATE_",l={stringify:function(a){var b=[];a=m(a,b);return JSON.stringify({root:a,references:b})},parse:function(a){a=JSON.parse(a);return p(a.root,a.references)}};"undefined"!==typeof define&&define.amd?define("Cryo",[],function(){return l}):"undefined"!==typeof module&&module.exports?module.exports=l:this.Cryo=l})();
