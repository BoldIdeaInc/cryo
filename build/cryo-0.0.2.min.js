/*
 The MIT license.
 @copyright Copyright (c) 2010 Skookum, skookum.com
*/
(function(){function f(a){return"object"===typeof a?a instanceof Array?"array":a instanceof Date?"date":"object":typeof a}function m(a,b,c){c=c||[];var d=f(a);if(d=t[d]){var e=c.indexOf(a);if(-1===e){var d=d(),g;for(g in a)a.hasOwnProperty(g)&&(d[g]=m(a[g],b,c));e=b.push({contents:d,value:n(a)})-1;c[e]=a}return h+e}return n(a)}function p(a,b){if(j(a,h)){var c=0|a.slice(h.length),d=b[c],c=q(d.value),d=d.contents,e;for(e in d)c[e]=p(d[e],b);return c}return q(a)}function n(a){var b=f(a);return"undefined"===
b?r:"function"===b?k+a.toString():"date"===b?l+a.getTime():Infinity===a?s:a}function q(a){if("string"===f(a)){if(a===r)return;if(j(a,k)){a=a.slice(k.length);var b=a.indexOf("(")+1,c=a.indexOf(")",b),b=a.slice(b,c),c=a.indexOf("{")+1,d=a.lastIndexOf("}")-1;a=a.slice(c,d);return new Function(b,a)}if(j(a,l))return a=parseInt(a.slice(l.length),10),new Date(a);if(a===s)return Infinity}return a}function j(a,b){return"string"===f(a)&&a.slice(0,b.length)===b}var t={object:function(){return{}},array:function(){return{}},
date:function(){return{}},"function":function(){return{}}},h="_CRYO_REF_",s="_CRYO_INFINITY_",k="_CRYO_FUNCTION_",r="_CRYO_UNDEFINED_",l="_CRYO_DATE_";Cryo={stringify:function(a){var b=[];a=m(a,b);return JSON.stringify({root:a,references:b})},parse:function(a){a=JSON.parse(a);return p(a.root,a.references)}};"undefined"!==typeof define&&define.amd?define("Cryo",[],function(){return Cryo}):"undefined"!==typeof module&&module.exports?module.exports=Cryo:this.Cryo=Cryo})();
